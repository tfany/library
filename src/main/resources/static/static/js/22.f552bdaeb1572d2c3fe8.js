webpackJsonp([22],{VGaC:function(e,t){},u5in:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("woOf"),i=r.n(n),l=r("FWz8"),s=r("xT6B"),a={pageNum:1,pageSize:10,orderSn:null,receiverKeyword:null,status:null,orderType:null,sourceType:null,createTime:null},o={name:"orderList",data:function(){return{listQuery:i()({},a),listLoading:!0,list:null,total:null,operateType:null,multipleSelection:[],closeOrder:{dialogVisible:!1,content:null,orderIds:[]}}},created:function(){this.getList()},filters:{formatCreateTime:function(e){var t=new Date(e);return Object(s.a)(t,"yyyy-MM-dd hh:mm:ss")},formatStatus:function(e){return 1===e?"已还":"未还"}},methods:{handleResetSearch:function(){this.listQuery=i()({},a)},handleSearchList:function(){this.listQuery.pageNum=1,this.getList()},handleSelectionChange:function(e){this.multipleSelection=e},handleViewOrder:function(e,t){this.$router.push({path:"/oms/orderDetail",query:{id:t.id}})},handleCloseOrder:function(e,t){this.closeOrder.dialogVisible=!0,this.closeOrder.orderIds=[t.id]},handleDeliveryOrder:function(e,t){var r=this.covertOrder(t);this.$router.push({path:"/oms/deliverOrderList",query:{list:[r]}})},handleViewLogistics:function(e,t){this.logisticsDialogVisible=!0},handleDeleteOrder:function(e,t){var r=[];r.push(t.id),this.deleteOrder(r)},handleBatchOperate:function(){if(null==this.multipleSelection||this.multipleSelection.length<1)this.$message({message:"请选择要操作的订单",type:"warning",duration:1e3});else if(1===this.operateType){for(var e=[],t=0;t<this.multipleSelection.length;t++)1===this.multipleSelection[t].status&&e.push(this.covertOrder(this.multipleSelection[t]));if(0===e.length)return void this.$message({message:"选中订单中没有可以发货的订单",type:"warning",duration:1e3});this.$router.push({path:"/oms/deliverOrderList",query:{list:e}})}else if(2===this.operateType){this.closeOrder.orderIds=[];for(var r=0;r<this.multipleSelection.length;r++)this.closeOrder.orderIds.push(this.multipleSelection[r].id);this.closeOrder.dialogVisible=!0}else if(3===this.operateType){for(var n=[],i=0;i<this.multipleSelection.length;i++)n.push(this.multipleSelection[i].id);this.deleteOrder(n)}},handleSizeChange:function(e){this.listQuery.pageNum=1,this.listQuery.pageSize=e,this.getList()},handleCurrentChange:function(e){this.listQuery.pageNum=e,this.getList()},handleCloseOrderConfirm:function(){var e=this;if(null!=this.closeOrder.content&&""!==this.closeOrder.content){var t=new URLSearchParams;t.append("ids",this.closeOrder.orderIds),t.append("note",this.closeOrder.content),Object(l.b)(t).then(function(t){e.closeOrder.orderIds=[],e.closeOrder.dialogVisible=!1,e.getList(),e.$message({message:"修改成功",type:"success",duration:1e3})})}else this.$message({message:"操作备注不能为空",type:"warning",duration:1e3})},getList:function(){var e=this;this.listLoading=!0,Object(l.d)(this.listQuery).then(function(t){e.listLoading=!1,e.list=t.data.list,e.total=t.data.total})},deleteOrder:function(e){var t=this;this.$confirm("是否要进行该删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var r=new URLSearchParams;r.append("ids",e),Object(l.c)(r).then(function(e){t.$message({message:"删除成功！",type:"success",duration:1e3}),t.getList()})})},covertOrder:function(e){var t=e.receiverProvince+e.receiverCity+e.receiverRegion+e.receiverDetailAddress;return{orderId:e.id,orderSn:e.orderSn,receiverName:e.receiverName,receiverPhone:e.receiverPhone,receiverPostCode:e.receiverPostCode,address:t,deliveryCompany:null,deliverySn:null}}}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-card",{staticClass:"operate-container",attrs:{shadow:"never"}},[r("i",{staticClass:"el-icon-tickets"}),e._v(" "),r("span",[e._v("租借列表")])]),e._v(" "),r("div",{staticClass:"table-container"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"orderTable",staticStyle:{width:"100%"},attrs:{data:e.list,border:""},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{label:"订单编号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.historyId))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"用户账号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.user.userId))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"用户姓名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.user.name))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"书籍名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.book.bookName))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"租借时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatCreateTime")(t.row.rentTime)))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"租借时长",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.time)+"天")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"租借数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.num)+"本")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"应还日期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatCreateTime")(new Date(new Date(t.row.rentTime).getTime()+24*t.row.time*60*60*1e3))))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"还书日期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatCreateTime")(t.row.remandTime)))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"订单金额",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.money)+"元")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"是否已还",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatStatus")(t.row.status))+" ")]}}])})],1)],1),e._v(" "),r("div",{staticClass:"pagination-container"},[r("el-pagination",{attrs:{background:"",layout:"total, sizes,prev, pager, next,jumper","current-page":e.listQuery.pageNum,"page-size":e.listQuery.pageSize,"page-sizes":[5,10,15],total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.listQuery,"pageNum",t)}}})],1)],1)},staticRenderFns:[]};var c=r("VU/8")(o,u,!1,function(e){r("VGaC")},"data-v-2c02ece2",null);t.default=c.exports}});
//# sourceMappingURL=22.f552bdaeb1572d2c3fe8.js.map