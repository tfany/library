{"version":3,"sources":["webpack:///src/views/customer/index/detailPage.vue","webpack:///./src/views/customer/index/detailPage.vue?f384","webpack:///./src/views/customer/index/detailPage.vue"],"names":["detailPage","name","data","value","day","count","user","created","this","getBook","getUserIfo","filters","formatPrice","val","toFixed","computed","sum","num","price","rank","discount","methods","_this","Object","product","$route","query","id","then","response","_this2","rent","_this3","status","stock","$message","type","message","$confirm","bookName","confirmButtonText","cancelButtonText","params","bookId","userId","rentDay","rentCount","money","order","catch","toIndex","$router","push","index_detailPage","render","_vm","_h","$createElement","_c","_self","attrs","span","offset","align","staticClass","src","img","alt","_e","_v","_s","author","_f","min","max","label","model","callback","$$v","expression","on","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/25.a48cea23b2012f8ff0de.js","sourcesContent":["<template>\n  <el-row>\n    <el-col :span=\"12\" :offset=\"5\">\n      <el-card align=\"center\">\n        <img class=\"image\" v-if=\"value.img\" :src=\"value.img\" :alt=\"value.bookName\"/>\n        <h3>{{value.bookName}}</h3>\n        <p class=\"desc\">作者:{{value.author}}</p>\n        <p class=\"desc\">库存:{{value.stock}}</p>\n        <p class=\"price\">售价: {{value.price}}元</p>\n        <p class=\"price\">租价: {{value.price/500 | formatPrice}}元 / 天</p>\n        <p class=\"desc\" v-if=\"user\">您是{{user.rank.name}},享受{{user.rank.discount*10}}折优惠</p>\n        <p><b>注意: 租价为售价的1/500,结算时四舍五入计算</b></p>\n        <p class=\"rent\">\n          租借天数:\n          <el-input-number v-model=\"day\" :min=\"1\" :max=\"365\" label=\"描述文字\"></el-input-number>\n        </p>\n        <p class=\"rent\">\n          租借数量:\n          <el-input-number v-model=\"count\" :min=\"1\" :max=\"value.stock\" label=\"描述文字\"></el-input-number>\n        </p>\n        <p class=\"rent\">\n          应付金额:\n          {{this.sum}}元\n        </p>\n        <el-button type=\"primary\" @click=\"rent\">\n          租借\n        </el-button>\n        <el-button type=\"primary\" @click=\"toIndex\">\n          返回首页\n        </el-button>\n      </el-card>\n    </el-col>\n  </el-row>\n</template>\n\n<script>\n  import {getProduct} from '@/api/product'\n  import {add} from '@/api/order'\n  import {getUserInfo as getInfo} from '@/api/user'\n\n\n  export default {\n    name: \"detailPage\",\n    data() {\n      return {\n        value: {},\n        day: 1,\n        count: 0,\n        user: null,\n      }\n    },\n    created() {\n      this.getBook();\n      this.getUserIfo();\n    },\n    filters: {\n      formatPrice(val) {\n        return val.toFixed(4);\n      }\n    },\n    computed: {\n      sum() {\n        let num = this.day * this.count * this.value.price / 500;\n        if(this.user){\n          num*=this.user.rank.discount;\n        }\n        return num.toFixed(2);\n      }\n    },\n    methods: {\n      getBook() {\n        getProduct(this.$route.query.id).then(response => {\n          this.value = response.data;\n        })\n      },\n      getUserIfo() {\n        getInfo().then(response => {\n          this.user = response.data;\n        })\n      },\n      rent() {\n        if(this.user==null){\n          this.$message({\n            type: \"error\",\n            message: \"请先登录\"\n          })\n         return;\n        }\n        if(this.user.status===0){\n          this.$message({\n            type: \"error\",\n            message: \"您已违规,没有权限借书,请联系管理员解封\"\n          })\n          return;\n        }\n        if(this.value.stock<=0){\n          this.$message({\n            type: \"error\",\n            message: \"库存不足\"\n          })\n          return;\n        }\n        if(this.count===0){\n          this.$message({\n            type: \"error\",\n            message: \"0本咋租????\"\n          })\n          return;\n        }\n\n        this.$confirm('确认支付' + this.sum + '元,租借' + this.count + '本' + this.value.bookName + this.day + '天吗?', '提示', {\n          confirmButtonText: '支付',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(\n          () => {\n            let params = {};\n            params.bookId = this.value.bookId;\n            params.userId = this.user.userId;\n            params.rentDay = this.day;\n            params.rentCount = this.count;\n            params.money = this.sum;\n            add(params).then((response) => {\n              this.$message({\n                type: 'success',\n                message: \"租借成功\"\n              })\n            });\n            this.count=0;\n            this.day=1;\n            this.getBook();\n            this.getBook();\n            this.getBook();\n            this.getBook();\n          }\n        ).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消支付'\n          });\n        });\n      },\n      toIndex(){\n        this.$router.push(\"/customer\")\n      },\n    }\n  }\n\n</script>\n\n<style scoped>\n  .image {\n    width: 400px;\n    height: 400px;\n  }\n\n  .rent {\n    margin: 10px 0 10px 0;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/customer/index/detailPage.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-row',[_c('el-col',{attrs:{\"span\":12,\"offset\":5}},[_c('el-card',{attrs:{\"align\":\"center\"}},[(_vm.value.img)?_c('img',{staticClass:\"image\",attrs:{\"src\":_vm.value.img,\"alt\":_vm.value.bookName}}):_vm._e(),_vm._v(\" \"),_c('h3',[_vm._v(_vm._s(_vm.value.bookName))]),_vm._v(\" \"),_c('p',{staticClass:\"desc\"},[_vm._v(\"作者:\"+_vm._s(_vm.value.author))]),_vm._v(\" \"),_c('p',{staticClass:\"desc\"},[_vm._v(\"库存:\"+_vm._s(_vm.value.stock))]),_vm._v(\" \"),_c('p',{staticClass:\"price\"},[_vm._v(\"售价: \"+_vm._s(_vm.value.price)+\"元\")]),_vm._v(\" \"),_c('p',{staticClass:\"price\"},[_vm._v(\"租价: \"+_vm._s(_vm._f(\"formatPrice\")(_vm.value.price/500))+\"元 / 天\")]),_vm._v(\" \"),(_vm.user)?_c('p',{staticClass:\"desc\"},[_vm._v(\"您是\"+_vm._s(_vm.user.rank.name)+\",享受\"+_vm._s(_vm.user.rank.discount*10)+\"折优惠\")]):_vm._e(),_vm._v(\" \"),_c('p',[_c('b',[_vm._v(\"注意: 租价为售价的1/500,结算时四舍五入计算\")])]),_vm._v(\" \"),_c('p',{staticClass:\"rent\"},[_vm._v(\"\\n        租借天数:\\n        \"),_c('el-input-number',{attrs:{\"min\":1,\"max\":365,\"label\":\"描述文字\"},model:{value:(_vm.day),callback:function ($$v) {_vm.day=$$v},expression:\"day\"}})],1),_vm._v(\" \"),_c('p',{staticClass:\"rent\"},[_vm._v(\"\\n        租借数量:\\n        \"),_c('el-input-number',{attrs:{\"min\":1,\"max\":_vm.value.stock,\"label\":\"描述文字\"},model:{value:(_vm.count),callback:function ($$v) {_vm.count=$$v},expression:\"count\"}})],1),_vm._v(\" \"),_c('p',{staticClass:\"rent\"},[_vm._v(\"\\n        应付金额:\\n        \"+_vm._s(this.sum)+\"元\\n      \")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.rent}},[_vm._v(\"\\n        租借\\n      \")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.toIndex}},[_vm._v(\"\\n        返回首页\\n      \")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-19b27809\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/customer/index/detailPage.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-19b27809\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./detailPage.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./detailPage.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./detailPage.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-19b27809\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./detailPage.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-19b27809\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/customer/index/detailPage.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}